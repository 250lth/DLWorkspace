@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<h1> Viewing Logs produced by Job: @ViewData["jobid"]</h1>

<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.10.2.min.js" type="text/javascript"></script>
<script>
    function GetDetail() {
        var url = "@ViewData["restapi"]/GetJobDetail?jobId=@ViewData["jobid"]";
        $.ajax({
            url: url,
            dataType: 'json',
            timeout: 10000 //10 second timeout,
        }).done(
            function (payload) {
                if (payload.log) {
                    console.log(payload.jobId);
                    objDiv = document.getElementById('logPanel');
                    objDiv.innerHTML = payload.log;
                    objDiv.scrollTop = objDiv.scrollHeight;
                } 
                else
                {
                    $('#logPanel').innerHTML ="No log yet!";
                }
            });
    }
    $(document).ready(function () {
        GetDetail();
        var refresh = setInterval(function () {
            GetDetail();
        }, 5000);

        });
</script>

<hr />


<div id="logPanel" style="height: 500px; background-color: #eee; white-space: pre; word-wrap: normal; overflow-x: scroll; overflow-y: scroll; font-family: 'Courier New'; font-weight: 600; font-size: 12px" readonly="" class="ng-binding">
    No log yet
</div>

